
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>2D ↔ 3D Фигуры</title>
    <style>
        body { font-family: Arial; background: #f0f0f0; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        canvas { border: 1px solid #ccc; background: white; margin-top: 10px; }
        .controls { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-top: 10px; }
        .controls input, select { width: 80px; text-align: center; }
    </style>
</head>
<body>
    <h2>2D ↔ 3D Фигуры</h2>
    <select id="shapeSelector" onchange="draw()">
        <option value="cube">Квадрат → Куб</option>
        <option value="sphere">Круг → Сфера</option>
    </select>
    <button onclick="toggle2D3D()">Переключить 2D/3D</button>

    <canvas id="canvas" width="500" height="500"></canvas>
    
    <div class="controls">
        <button onclick="alpha -= step; draw()">←</button>
        <button onclick="alpha += step; draw()">→</button>
        <button onclick="beta += step; draw()">↑</button>
        <button onclick="beta -= step; draw()">↓</button>
        <button onclick="zk += zh; updateZk(); draw()">Z+</button>
        <button onclick="zk -= zh; updateZk(); draw()">Z-</button>
        Альфа: <input type="text" id="alphaVal" readonly>
        Бета: <input type="text" id="betaVal" readonly>
        Zk: <input type="text" id="zkVal" readonly>
    </div>

    <script>
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        let alpha = -30;
        let beta = -30;
        let zk = 1200;
        const zrr = 500;
        let zpl = zk - zrr;
        const zh = 20;
        const step = 10;
        const mp = 150;
        const cx = 250, cy = 250;
        let is3D = false;

        const cube = [[-1,-1,1], [1,-1,1], [1,1,1], [-1,1,1], [-1,-1,-1], [1,-1,-1], [1,1,-1], [-1,1,-1]];
        const cubeEdges = [[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]];

        function rotateAndProject(x, y, z) {
            let aRad = alpha * Math.PI / 180;
            let bRad = beta * Math.PI / 180;

            let xx = x * Math.cos(aRad) - y * Math.sin(aRad);
            let yy = x * Math.sin(aRad) * Math.cos(bRad) + y * Math.cos(aRad) * Math.cos(bRad) - z * Math.sin(bRad);
            let zz = x * Math.sin(aRad) * Math.sin(bRad) + y * Math.cos(aRad) * Math.sin(bRad) + z * Math.cos(bRad);

            let factor = (zk - zpl) / (zk - zz);
            xx *= factor;
            yy *= factor;

            return [cx + xx * mp, cy - yy * mp];
        }

        function drawLine(p1, p2, color="blue") {
            ctx.beginPath();
            ctx.moveTo(...p1);
            ctx.lineTo(...p2);
            ctx.strokeStyle = color;
            ctx.stroke();
        }

        function drawSquare() {
            let size = 100;
            ctx.strokeRect(cx - size/2, cy - size/2, size, size);
        }

        function drawCube() {
            let pts = cube.map(p => rotateAndProject(...p));
            cubeEdges.forEach(([i, j]) => drawLine(pts[i], pts[j]));
        }

        function drawCircle() {
            ctx.beginPath();
            ctx.arc(cx, cy, 100, 0, 2 * Math.PI);
            ctx.stroke();
        }

        function drawSphere() {
            for (let i = 0; i <= Math.PI; i += Math.PI / 10) {
                let ring = [];
                for (let j = 0; j <= 2 * Math.PI; j += Math.PI / 10) {
                    let x = Math.sin(i) * Math.cos(j);
                    let y = Math.sin(i) * Math.sin(j);
                    let z = Math.cos(i);
                    ring.push(rotateAndProject(x, y, z));
                }
                for (let k = 0; k < ring.length - 1; k++) {
                    drawLine(ring[k], ring[k+1], "blue");
                }
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let shape = document.getElementById("shapeSelector").value;
            if (!is3D) {
                if (shape === "cube") drawSquare();
                else drawCircle();
            } else {
                if (shape === "cube") drawCube();
                else drawSphere();
            }
            document.getElementById("alphaVal").value = alpha;
            document.getElementById("betaVal").value = beta;
            document.getElementById("zkVal").value = zk;
        }

        function updateZk() {
            zpl = zk - zrr;
        }

        function toggle2D3D() {
            is3D = !is3D;
            draw();
        }

        draw();
    </script>
</body>
</html>
